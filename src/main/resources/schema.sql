CREATE TABLE IF NOT EXISTS USERS
(
    user_id   INT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    user_name VARCHAR(200) NOT NULL,
    email     VARCHAR(200) NOT NULL,
    CONSTRAINT pk_user PRIMARY KEY (user_id),
    CONSTRAINT uq_user_email UNIQUE (email)
);

CREATE TABLE IF NOT EXISTS ITEMS
(
    item_id      INT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    item_name    VARCHAR(200) NOT NULL,
    description  VARCHAR(200) NOT NULL,
    is_available BOOLEAN      NOT NULL,
    owner_id     INT          NOT NULL REFERENCES USERS (user_id) ON DELETE CASCADE,
    request_id   INT,
    CONSTRAINT pk_item PRIMARY KEY (item_id)
);

CREATE TABLE IF NOT EXISTS BOOKINGS
(
    booking_id INT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    start_date TIMESTAMP    NOT NULL,
    end_date   TIMESTAMP    NOT NULL,
    item_id    INT     NOT NULL REFERENCES ITEMS (item_id) ON DELETE CASCADE,
    booker_id  INT     NOT NULL REFERENCES USERS (user_id) ON DELETE CASCADE,
    status     VARCHAR NOT NULL,
    CONSTRAINT pk_booking PRIMARY KEY (booking_id)
);

CREATE TABLE IF NOT EXISTS REQUESTS
(
    request_id   INT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    description  VARCHAR(200) NOT NULL,
    requester_id INT          NOT NULL REFERENCES USERS (user_id) ON DELETE CASCADE,
    CONSTRAINT pk_request PRIMARY KEY (request_id)
);

CREATE TABLE IF NOT EXISTS COMMENTS
(
    comment_id   INT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    comment_text VARCHAR(200) NOT NULL,
    item_id      INT          NOT NULL REFERENCES ITEMS (item_id) ON DELETE CASCADE,
    author_id    INT          NOT NULL REFERENCES USERS (user_id) ON DELETE CASCADE,
    created TIMESTAMP NOT NULL,
    CONSTRAINT pk_comment PRIMARY KEY (comment_id)
)